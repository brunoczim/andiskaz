<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A trait used to implement the raw communication with the X11 server."><title>Stream in x11rb::rust_connection - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="x11rb" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0 (cc66ad468 2023-10-03)" data-channel="1.73.0" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-1596385f77d47ef2.css" data-theme-dark-css="dark-0a43001d3fc2282c.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-1596385f77d47ef2.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-0a43001d3fc2282c.css"><link rel="stylesheet" href="../../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../x11rb/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../x11rb/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Stream</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.poll">poll</a></li><li><a href="#tymethod.read">read</a></li><li><a href="#tymethod.write">write</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.read_exact">read_exact</a></li><li><a href="#method.write_vectored">write_vectored</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In x11rb::rust_connection</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">x11rb</a>::<wbr><a href="index.html">rust_connection</a>::<wbr><a class="trait" href="#">Stream</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/x11rb/rust_connection/stream.rs.html#51-173">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Stream {
    // Required methods
    fn <a href="#tymethod.poll" class="fn">poll</a>(&amp;self, mode: <a class="enum" href="enum.PollMode.html" title="enum x11rb::rust_connection::PollMode">PollMode</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.read" class="fn">read</a>(
        &amp;self,
        buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>],
        fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.write" class="fn">write</a>(&amp;self, buf: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>], fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>&gt;;

    // Provided methods
    fn <a href="#method.read_exact" class="fn">read_exact</a>(
        &amp;self,
        buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>],
        fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.unit.html">()</a>&gt; { ... }
<span class="item-spacer"></span>    fn <a href="#method.write_vectored" class="fn">write_vectored</a>(
        &amp;self,
        bufs: &amp;[<a class="struct" href="https://doc.rust-lang.org/1.73.0/std/io/struct.IoSlice.html" title="struct std::io::IoSlice">IoSlice</a>&lt;'_&gt;],
        fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;
    ) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>&gt; { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A trait used to implement the raw communication with the X11 server.</p>
<p>None of the functions of this trait shall return <a href="https://doc.rust-lang.org/1.73.0/std/io/error/enum.ErrorKind.html#variant.Interrupted" title="variant std::io::error::ErrorKind::Interrupted"><code>std::io::ErrorKind::Interrupted</code></a>.
If a system call fails with this error, the implementation should try again.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.poll" class="method"><a class="src rightside" href="../../src/x11rb/rust_connection/stream.rs.html#67">source</a><h4 class="code-header">fn <a href="#tymethod.poll" class="fn">poll</a>(&amp;self, mode: <a class="enum" href="enum.PollMode.html" title="enum x11rb::rust_connection::PollMode">PollMode</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Waits for level-triggered read and/or write events on the stream.</p>
<p>This function does not return what caused it to complete the poll.
Instead, callers should try to read or write and check for
<a href="https://doc.rust-lang.org/1.73.0/std/io/error/enum.ErrorKind.html#variant.WouldBlock" title="variant std::io::error::ErrorKind::WouldBlock"><code>std::io::ErrorKind::WouldBlock</code></a>.</p>
<p>This function is allowed to spuriously return even if the stream
is neither readable nor writable. However, it shall not do it
continuously, which would cause a 100% CPU usage.</p>
<h5 id="multithreading"><a href="#multithreading">Multithreading</a></h5>
<p>If <code>Self</code> is <code>Send + Sync</code> and <code>poll</code> is used concurrently from more than
one thread, all threads should wake when the stream becomes readable (when
<code>read</code> is <code>true</code>) or writable (when <code>write</code> is <code>true</code>).</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.read" class="method"><a class="src rightside" href="../../src/x11rb/rust_connection/stream.rs.html#90">source</a><h4 class="code-header">fn <a href="#tymethod.read" class="fn">read</a>(
    &amp;self,
    buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>],
    fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class="docblock"><p>Read some bytes and FDs from this reader without blocking, returning how many bytes
were read.</p>
<p>This function works like <a href="https://doc.rust-lang.org/1.73.0/std/io/trait.Read.html#tymethod.read" title="method std::io::Read::read"><code>std::io::Read::read</code></a>, but also supports the reception of file
descriptors. Any received file descriptors are appended to the given <code>fd_storage</code>.
Whereas implementation of <a href="https://doc.rust-lang.org/1.73.0/std/io/trait.Read.html#tymethod.read" title="method std::io::Read::read"><code>std::io::Read::read</code></a> are allowed to block or not to block,
this method shall never block and return <code>ErrorKind::WouldBlock</code> if needed.</p>
<p>This function does not guarantee that all file descriptors were sent together with the data
with which they are received. However, file descriptors may not be received later than the
data that was sent at the same time. Instead, file descriptors may only be received
earlier.</p>
<h5 id="multithreading-1"><a href="#multithreading-1">Multithreading</a></h5>
<p>If <code>Self</code> is <code>Send + Sync</code> and <code>read</code> is used concurrently from more than one thread:</p>
<ul>
<li>Both the data and the file descriptors shall be read in order, but possibly
interleaved across threads.</li>
<li>Neither the data nor the file descriptors shall be duplicated.</li>
<li>The returned value shall always be the actual number of bytes read into <code>buf</code>.</li>
</ul>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.write" class="method"><a class="src rightside" href="../../src/x11rb/rust_connection/stream.rs.html#153">source</a><h4 class="code-header">fn <a href="#tymethod.write" class="fn">write</a>(&amp;self, buf: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>], fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class="docblock"><p>Write a buffer and some FDs into this writer without blocking, returning how many
bytes were written.</p>
<p>This function works like <a href="https://doc.rust-lang.org/1.73.0/std/io/trait.Write.html#tymethod.write" title="method std::io::Write::write"><code>std::io::Write::write</code></a>, but also supports sending file
descriptors. The <code>fds</code> argument contains the file descriptors to send. The order of file
descriptors is maintained. Whereas implementation of <a href="https://doc.rust-lang.org/1.73.0/std/io/trait.Write.html#tymethod.write" title="method std::io::Write::write"><code>std::io::Write::write</code></a> are
allowed to block or not to block, this function must never block and return
<code>ErrorKind::WouldBlock</code> if needed.</p>
<p>This function does not guarantee that all file descriptors are sent together with the data.
Any file descriptors that were sent are removed from the beginning of the given <code>Vec</code>.</p>
<p>There is no guarantee that the given file descriptors are received together with the given
data. File descriptors might be received earlier than their corresponding data. It is not
allowed for file descriptors to be received later than the bytes that were sent at the same
time.</p>
<h5 id="multithreading-2"><a href="#multithreading-2">Multithreading</a></h5>
<p>If <code>Self</code> is <code>Send + Sync</code> and <code>write</code> is used concurrently from more than one thread:</p>
<ul>
<li>Both the data and the file descriptors shall be written in order, but possibly
interleaved across threads.</li>
<li>Neither the data nor the file descriptors shall be duplicated.</li>
<li>The returned value shall always be the actual number of bytes written from <code>buf</code>.</li>
</ul>
</div></details></div><h2 id="provided-methods" class="small-section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.read_exact" class="method"><a class="src rightside" href="../../src/x11rb/rust_connection/stream.rs.html#109-126">source</a><h4 class="code-header">fn <a href="#method.read_exact" class="fn">read_exact</a>(
    &amp;self,
    buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.u8.html">u8</a>],
    fd_storage: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Read the exact number of bytes required to fill <code>buf</code> and also some amount of FDs.</p>
<p>Unlike <code>read</code>, this method always blocks until <code>buf</code> has been filled or there is an
error.</p>
<p>This function works like <a href="https://doc.rust-lang.org/1.73.0/std/io/trait.Read.html#tymethod.read" title="method std::io::Read::read"><code>std::io::Read::read</code></a>, but also supports the reception of file
descriptors. Any received file descriptors are appended to the given <code>fd_storage</code>.</p>
<p>This function does not guarantee that all file descriptors were sent together with the data
with which they are received. However, file descriptors may not be received later than the
data that was sent at the same time. Instead, file descriptors may only be received
earlier.</p>
<h5 id="multithreading-3"><a href="#multithreading-3">Multithreading</a></h5>
<p>Same as <code>read</code>. In any case, if this function returns without error, <code>buf.len()</code> bytes
should have been read into <code>buf</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.write_vectored" class="method"><a class="src rightside" href="../../src/x11rb/rust_connection/stream.rs.html#165-172">source</a><h4 class="code-header">fn <a href="#method.write_vectored" class="fn">write_vectored</a>(
    &amp;self,
    bufs: &amp;[<a class="struct" href="https://doc.rust-lang.org/1.73.0/std/io/struct.IoSlice.html" title="struct std::io::IoSlice">IoSlice</a>&lt;'_&gt;],
    fds: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.73.0/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../utils/struct.RawFdContainer.html" title="struct x11rb::utils::RawFdContainer">RawFdContainer</a>&gt;
) -&gt; <a class="type" href="https://doc.rust-lang.org/1.73.0/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.73.0/std/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class="docblock"><p>Like <code>write</code>, except that it writes from a slice of buffers. Like <code>write</code>, this
method must never block.</p>
<p>This method must behave as a call to <code>write</code> with the buffers concatenated would.</p>
<p>The default implementation calls <code>write</code> with the first nonempty buffer provided.</p>
<h5 id="multithreading-4"><a href="#multithreading-4">Multithreading</a></h5>
<p>Same as <code>write</code>.</p>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-Stream-for-DefaultStream" class="impl"><a class="src rightside" href="../../src/x11rb/rust_connection/stream.rs.html#389-549">source</a><a href="#impl-Stream-for-DefaultStream" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.Stream.html" title="trait x11rb::rust_connection::Stream">Stream</a> for <a class="struct" href="struct.DefaultStream.html" title="struct x11rb::rust_connection::DefaultStream">DefaultStream</a></h3></section></div><script src="../../implementors/x11rb/rust_connection/stream/trait.Stream.js" async></script></section></div></main></body></html>