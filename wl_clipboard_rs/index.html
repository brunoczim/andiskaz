<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A safe Rust crate for working with the Wayland clipboard."><meta name="keywords" content="rust, rustlang, rust-lang, wl_clipboard_rs"><title>wl_clipboard_rs - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../wl_clipboard_rs/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Crate wl_clipboard_rs</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.4.1</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all wl_clipboard_rs's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li></ul></div><div id="sidebar-vars" data-name="wl_clipboard_rs" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">wl_clipboard_rs</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/wl_clipboard_rs/lib.rs.html#1-126" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A safe Rust crate for working with the Wayland clipboard.</p>
<p>This crate is intended to be used by terminal applications, clipboard managers and other
utilities which don’t spawn Wayland surfaces (windows). If your application has a window,
please use the appropriate Wayland protocols for interacting with the Wayland clipboard
(<code>wl_data_device</code> from the core Wayland protocol, the <code>primary_selection</code> protocol for the
primary selection), for example via the
<a href="https://crates.io/crates/smithay-clipboard">smithay-clipboard</a> crate.</p>
<p>The protocol used for clipboard interaction is <code>data-control</code> from
<a href="https://github.com/swaywm/wlr-protocols">wlroots</a>. When using the regular clipboard, the
compositor must support the first version of the protocol. When using the “primary” clipboard,
the compositor must support the second version of the protocol (or higher).</p>
<p>For example applications using these features, see <code>src/bin/wl_copy.rs</code> and
<code>src/bin/wl_paste.rs</code> which implement terminal apps similar to
<a href="https://github.com/bugaevc/wl-clipboard">wl-clipboard</a> or <code>src/bin/wl_clip.rs</code> which
implements a Wayland version of <code>xclip</code>.</p>
<p>The Rust implementation of the Wayland client is used by default; use the <code>native_lib</code> feature
to link to <code>libwayland-client.so</code> for communication instead. A <code>dlopen</code> feature is also
available for loading <code>libwayland-client.so</code> dynamically at runtime rather than linking to it.</p>
<p>The code of the crate itself (and the code of the example utilities) is 100% safe Rust. This
doesn’t include the dependencies.</p>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<p>Copying to the regular clipboard:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">wl_clipboard_rs::copy</span>::{<span class="ident">MimeType</span>, <span class="ident">Options</span>, <span class="ident">Source</span>};

<span class="kw">let</span> <span class="ident">opts</span> <span class="op">=</span> <span class="ident">Options::new</span>();
<span class="ident">opts</span>.<span class="ident">copy</span>(<span class="ident">Source::Bytes</span>(<span class="string">&quot;Hello world!&quot;</span>.<span class="ident">to_string</span>().<span class="ident">into_bytes</span>().<span class="ident">into</span>()), <span class="ident">MimeType::Autodetect</span>)<span class="question-mark">?</span>;</code></pre></div>
<p>Pasting plain text from the regular clipboard:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">std::io::Read</span>;
<span class="kw">use</span> <span class="ident">wl_clipboard_rs</span>::{<span class="ident">paste</span>::{<span class="ident">get_contents</span>, <span class="ident">ClipboardType</span>, <span class="ident">Error</span>, <span class="ident">MimeType</span>, <span class="ident">Seat</span>}};

<span class="kw">let</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">get_contents</span>(<span class="ident">ClipboardType::Regular</span>, <span class="ident">Seat::Unspecified</span>, <span class="ident">MimeType::Text</span>);
<span class="kw">match</span> <span class="ident">result</span> {
    <span class="prelude-val">Ok</span>((<span class="kw-2">mut</span> <span class="ident">pipe</span>, <span class="kw">_</span>)) <span class="op">=</span><span class="op">&gt;</span> {
        <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">contents</span> <span class="op">=</span> <span class="macro">vec!</span>[];
        <span class="ident">pipe</span>.<span class="ident">read_to_end</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">contents</span>)<span class="question-mark">?</span>;
        <span class="macro">println!</span>(<span class="string">&quot;Pasted: {}&quot;</span>, <span class="ident">String::from_utf8_lossy</span>(<span class="kw-2">&amp;</span><span class="ident">contents</span>));
    }

    <span class="prelude-val">Err</span>(<span class="ident">Error::NoSeats</span>) <span class="op">|</span> <span class="prelude-val">Err</span>(<span class="ident">Error::ClipboardEmpty</span>) <span class="op">|</span> <span class="prelude-val">Err</span>(<span class="ident">Error::NoMimeType</span>) <span class="op">=</span><span class="op">&gt;</span> {
        <span class="comment">// The clipboard is empty or doesn&#39;t contain text, nothing to worry about.</span>
    }

    <span class="prelude-val">Err</span>(<span class="ident">err</span>) <span class="op">=</span><span class="op">&gt;</span> <span class="prelude-val">Err</span>(<span class="ident">err</span>)<span class="question-mark">?</span>
}</code></pre></div>
<p>Checking if the “primary” clipboard is supported (note that this might be unnecessary depending
on your crate usage, the regular copying and pasting functions do report if the primary
selection is unsupported when it is requested):</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">wl_clipboard_rs::utils</span>::{<span class="ident">is_primary_selection_supported</span>, <span class="ident">PrimarySelectionCheckError</span>};

<span class="kw">match</span> <span class="ident">is_primary_selection_supported</span>() {
    <span class="prelude-val">Ok</span>(<span class="ident">supported</span>) <span class="op">=</span><span class="op">&gt;</span> {
        <span class="comment">// We have our definitive result. False means that either data-control version 1</span>
        <span class="comment">// is present (which does not support the primary selection), or that data-control</span>
        <span class="comment">// version 2 is present and it did not signal the primary selection support.</span>
    },
    <span class="prelude-val">Err</span>(<span class="ident">PrimarySelectionCheckError::NoSeats</span>) <span class="op">=</span><span class="op">&gt;</span> {
        <span class="comment">// Impossible to give a definitive result. Primary selection may or may not be</span>
        <span class="comment">// supported.</span>

        <span class="comment">// The required protocol (data-control version 2) is there, but there are no seats.</span>
        <span class="comment">// Unfortunately, at least one seat is needed to check for the primary clipboard</span>
        <span class="comment">// support.</span>
    },
    <span class="prelude-val">Err</span>(<span class="ident">PrimarySelectionCheckError::MissingProtocol</span> { .. }) <span class="op">=</span><span class="op">&gt;</span> {
        <span class="comment">// The data-control protocol (required for wl-clipboard-rs operation) is not</span>
        <span class="comment">// supported by the compositor.</span>
    },
    <span class="prelude-val">Err</span>(<span class="kw">_</span>) <span class="op">=</span><span class="op">&gt;</span> {
        <span class="comment">// Some communication error occurred.</span>
    }
}</code></pre></div>
<h1 id="included-terminal-utilities" class="section-header"><a href="#included-terminal-utilities">Included terminal utilities</a></h1>
<ul>
<li><code>wl-paste</code>: implements <code>wl-paste</code> from
<a href="https://github.com/bugaevc/wl-clipboard">wl-clipboard</a>.</li>
<li><code>wl-copy</code>: implements <code>wl-copy</code> from <a href="https://github.com/bugaevc/wl-clipboard">wl-clipboard</a>.</li>
<li><code>wl-clip</code>: a Wayland version of <code>xclip</code>.</li>
</ul>
</div></details><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="mod" href="copy/index.html" title="wl_clipboard_rs::copy mod">copy</a></div><div class="item-right docblock-short"><p>Copying and clearing clipboard contents.</p>
</div><div class="item-left module-item"><a class="mod" href="paste/index.html" title="wl_clipboard_rs::paste mod">paste</a></div><div class="item-right docblock-short"><p>Getting the offered MIME types and the clipboard contents.</p>
</div><div class="item-left module-item"><a class="mod" href="utils/index.html" title="wl_clipboard_rs::utils mod">utils</a></div><div class="item-right docblock-short"><p>Helper functions.</p>
</div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="wl_clipboard_rs" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script>
</body></html>